<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multi-Link Request Demo</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="container">
    <h1>Multi-Link Request Demo</h1>
    
    <div class="section credentials-section">
      <h2>üîê Save Credentials</h2>
      <div class="credentials-form">
        <div class="form-group">
          <input type="text" id="userId" placeholder="Enter your ID">
        </div>
        <div class="form-group">
          <input type="password" id="password" placeholder="Enter your password">
        </div>
        <button class="save-btn" onclick="saveCredentials()">Save Credentials</button>
      </div>
    </div>

    <div class="section links-section">
      <h2>üîó Links</h2>
      <div class="links-container" id="links-container">
        <div class="link-row" id="link-1">
          <input type="text" placeholder="Enter Link 1" class="link-input">
          <button class="send-btn" onclick="sendRequest(this)">Send</button>
        </div>
      </div>
      <button class="add-link-btn" onclick="addLink()">+</button>
    </div>
  </div>

  <script>
    let credentials = { id: "", password: "" };
    let linkCount = 1;
    const maxLinks = 5;

    function saveCredentials() {
      const id = document.getElementById("userId").value.trim();
      const pwd = document.getElementById("password").value.trim();
      
      if (id && pwd) {
        credentials.id = id;
        credentials.password = pwd;
        
        // Add visual feedback
        const btn = event.target;
        btn.textContent = "‚úì Saved!";
        btn.style.background = "linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)";
        
        setTimeout(() => {
          btn.textContent = "Save Credentials";
        }, 2000);
        
        showNotification("Credentials saved successfully!", "success");
      } else {
        showNotification("Please enter both ID and Password.", "error");
      }
    }

    function addLink() {
      if (linkCount >= maxLinks) {
        showNotification("You can add up to 5 links only!", "warning");
        return;
      }
      
      linkCount++;
      const container = document.getElementById("links-container");
      const div = document.createElement("div");
      div.className = "link-row";
      div.id = link-${linkCount};
      div.innerHTML = `
        <input type="text" placeholder="Enter Link ${linkCount}" class="link-input">
        <button class="send-btn" onclick="sendRequest(this)">Send</button>
      `;
      container.appendChild(div);
      
      // Animate the new row
      div.style.opacity = "0";
      div.style.transform = "translateY(20px)";
      setTimeout(() => {
        div.style.transition = "all 0.3s ease";
        div.style.opacity = "1";
        div.style.transform = "translateY(0)";
      }, 10);
    }

    function sendRequest(button) {
      const input = button.previousElementSibling;
      const url = input.value.trim();

      if (!url) {
        showNotification("Please enter a URL!", "error");
        return;
      }
      if (!credentials.id || !credentials.password) {
        showNotification("Please save credentials first!", "error");
        return;
      }

      console.log(url)
      console.log(credentials.id)
      console.log(credentials.password)

      button.classList.add('loading');
      button.disabled = true;

      fetch('/scrape', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          url: url,
          username: credentials.id,
          password: credentials.password
        })
      })
      .then(res => res.json())
      .then(data => {
        const newWindow = window.open("", "_blank");
        newWindow.document.write(<pre>${JSON.stringify(data, null, 2)}</pre>);
        showNotification("Request sent successfully!", "success");
      })
      .catch(() => showNotification("Server error!", "error"))
      .finally(() => {
        button.classList.remove('loading');
        button.disabled = false;
      });
    }

    // Notification system
    function showNotification(message, type) {
      const notification = document.createElement('div');
      notification.className = notification ${type};
      notification.innerHTML = `
        <span>${message}</span>
        <button onclick="this.parentElement.remove()" style="background: none; border: none; color: inherit; font-size: 18px; cursor: pointer; padding: 0 0 0 10px;">√ó</button>
      `;
      
      // Add notification styles
      Object.assign(notification.style, {
        position: 'fixed',
        top: '20px',
        right: '20px',
        padding: '15px 20px',
        borderRadius: '10px',
        color: 'white',
        fontWeight: '500',
        zIndex: '1000',
        display: 'flex',
        alignItems: 'center',
        justifyContent: 'space-between',
        minWidth: '300px',
        boxShadow: '0 5px 15px rgba(0,0,0,0.2)',
        transform: 'translateX(400px)',
        transition: 'transform 0.3s ease'
      });

      // Set background based on type
      const colors = {
        success: 'linear-gradient(135deg, #27ae60, #2ecc71)',
        error: 'linear-gradient(135deg, #e74c3c, #c0392b)',
        warning: 'linear-gradient(135deg, #f39c12, #e67e22)'
      };
      notification.style.background = colors[type] || colors.success;

      document.body.appendChild(notification);
      
      // Animate in
      setTimeout(() => {
        notification.style.transform = 'translateX(0)';
      }, 10);

      // Auto remove after 5 seconds
      setTimeout(() => {
        notification.style.transform = 'translateX(400px)';
        setTimeout(() => notification.remove(), 300);
      }, 5000);
    }

    // Add keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      // Ctrl+Enter to save credentials
      if (e.ctrlKey && e.key === 'Enter') {
        const userId = document.getElementById('userId');
        const password = document.getElementById('password');
        if (document.activeElement === userId || document.activeElement === password) {
          saveCredentials();
        }
      }
      
      // Ctrl+Plus to add link
      if (e.ctrlKey && e.key === '+') {
        e.preventDefault();
        addLink();
      }
    });
  </script>
</body>
</html>